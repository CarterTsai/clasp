

import mbb


db = mbb.loadDatabase()

gly0 = mbb.Monomer("gly")
pro1 = mbb.Monomer("pro4(2S4S)")
pro2 = mbb.Monomer("pro4(2S4S)")
gly3 = mbb.Monomer("gly")


olig = mbb.Oligomer(db)

olig.addMonomer(gly0)
olig.addMonomer(pro1)
olig.addMonomer(pro2)
olig.addMonomer(gly3)

olig.couple(gly0,"dkp",pro1)
olig.couple(pro1,"dkp",pro2)
olig.couple(pro2,"dkp",gly3)

olig.createBuilders()


if ( olig.getHasError() ):
    print olig.getErrorMessage()
    sys.exit(1)
else:
    print "Oligomer OK"

olig.buildCoordinates()


print olig.getMolecule().asXml(True).asString()
agg = mbb.Aggregate()
agg.addMolecule(olig.getMolecule())

xmlGraphics = mbb.xmlGraphics("main")
xmlGraphics.addChild(agg.asXml(True))
xmlGraphics.writeToFileName("render.xml")

