<extractorDatabase>
<topologyDatabase>
 <monomerSelectorLayout>
  <branch name="pro4">
	<monomer name="pro4(2S4S)"/>
	<monomer name="pro4(2S4R)"/>
	<monomer name="pro4(2R4S)"/>
	<monomer name="pro4(2R4R)"/>
  </branch>
  <branch name="amino acids">
	<monomer name="dap"/>
	<monomer name="tyr"/>
  </branch>
  <branch name="ends">
	<branch name="protective branchs">
		<monomer name="Boc"/>
		<monomer name="Cbz"/>
	</branch>
	<branch name="esters">
		<monomer name="OTFP"/>
		<monomer name="OMe"/>
	</branch>
	<branch name="capping branchs">
	 	<monomer name="ace"/>
	</branch>
	<monomer name="resinAmide"/>
	<monomer name="h_2"/>
  </branch>
 </monomerSelectorLayout>

  <mold name="tyrosine">
   <groups>AminoAcid</groups>
   <monomers>
	<monomer name="styr" pdb="TYR"/>
	<monomer name="rtyr" pdb="TYD"/>
   </monomers>
   <residue id="5">
    <atom chg="-0.465" element="N" hybrid="sp3" id="1"	name="NA" type="NH1"/>
    <atom chg="0.310" element="H" hybrid="sp3" id="2"	name="HN" type="H"/>
    <atom chg="0.070" element="C" hybrid="sp3" id="5"	name="CA" type="CT"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="10"	name="HA" type="HA"/>
    <atom chg="-0.180" element="C" hybrid="sp3" id="6"	name="CB" type="CT"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="7"	name="HB2" type="HA"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="8"	name="HB1" type="HA"/>
    <atom chg="0.005" element="C" hybrid="sp2" id="9"	name="C1" type="CA"/>
    <atom chg="-0.115" element="C" hybrid="sp2" id="11"	name="C6" type="CA"/>
    <atom chg="0.115" element="H" hybrid="sp3" id="12"	name="H6" type="HA"/>
    <atom chg="-0.115" element="C" hybrid="sp2" id="13"	name="C5" type="CA"/>
    <atom chg="0.115" element="H" hybrid="sp3" id="14"	name="H5" type="HA"/>
    <atom chg="0.110" element="C" hybrid="sp2" id="15"	name="C4" type="C"/>
    <atom chg="-0.545" element="O" hybrid="sp3" id="16"	name="O4" type="OH"/>
    <atom chg="0.435" element="H" hybrid="sp3" id="17"	name="HO5" type="H"/>
    <atom chg="-0.115" element="C" hybrid="sp2" id="18"	name="C3" type="CA"/>
    <atom chg="0.115" element="H" hybrid="sp3" id="19"	name="H3" type="HA"/>
    <atom chg="-0.115" element="C" hybrid="sp2" id="20"	name="C2" type="CA"/>
    <atom chg="0.115" element="H" hybrid="sp3" id="21"	name="H2" type="HA"/>
    <atom chg="0.505" element="C" hybrid="sp2" id="3"	name="CAC" type="C"/>
    <atom chg="-0.510" element="O" hybrid="sp2" id="4"	name="OA" type="O"/>
    <bond from="1" order="single" to="2"/>
    <bond from="1" order="single" to="5"/>
    <bond from="3" order="single" to="5"/>
    <bond from="3" order="double" to="4"/>
    <bond from="5" order="single" to="10"/>
    <bond from="5" order="single" to="6"/>
    <bond from="6" order="single" to="7"/>
    <bond from="6" order="single" to="8"/>
    <bond from="6" order="single" to="9"/>
    <bond from="9" order="double" to="11"/>
    <bond from="9" order="double" to="20"/>
    <bond from="11" order="single" to="12"/>
    <bond from="11" order="double" to="13"/>
    <bond from="13" order="single" to="14"/>
    <bond from="13" order="double" to="15"/>
    <bond from="15" order="double" to="18"/>
    <bond from="15" order="single" to="16"/>
    <bond from="16" order="single" to="17"/>
    <bond from="18" order="single" to="19"/>
    <bond from="18" order="double" to="20"/>
    <bond from="20" order="single" to="21"/>
   </residue>
   <coupling in="dkp"></coupling>
   <charmmCode>
DIHEdral CAC CA NA HN
DIHEdral CB CA CAC OA
DIHEdral C1 CB CA NA
DIHEdral C6 C1 CB CA
DIHEdral C1 CB CA CAC
DIHEdral NA CA CAC OA
DIHEdral C2 C1 CB CA
DIHEdral CB CA NA HN
DIHEdral C3 C4 O4 HO5
DIHEdral C5 C4 O4 HO5
IMPRoper C6 C5 C4 O4
IMPRoper C3 C2 C1 C6
IMPRoper C1 C2 C3 C4
IMPRoper C3 C2 C1 CB
IMPRoper C2 C1 C6 C5
IMPRoper C2 C3 C4 C5
IMPRoper C5 C6 C1 CB
IMPRoper C2 C3 C4 O4
IMPRoper C3 C4 C5 C6
IMPRoper C1 C6 C5 C4
   </charmmCode>
</mold>

<mold name="resinAmide">
 <monomers>
  <monomer name="resinAmide" pdb="NH2"/>
 </monomers>
 <residue>
  <atom id='1' name='N' element='N' hybrid='sp3' type='NH2' chg='0'/>
  <atom id='2' name='HN1' element='H' hybrid='sp' type='H' chg='0'/>
  <atom id='3' name='HN2' element='H' hybrid='sp' type='H' chg='0'/>
  <bond order='single' from='1' to='2'/>
  <bond order='single' from='1' to='3'/>
 </residue>
 <comment> </comment>
 <coupling>peptide</coupling>
</mold>


<mold name="acetate">
 <monomers>
  <monomer name="ace" pdb="ACE"/>
 </monomers>
 <residue>
  <atom id='1' name='CA' element='C' hybrid='sp3' type='CT' chg='0'/>
  <atom id='2' name='HA1' element='H' hybrid='sp' type='HC' chg='0'/>
  <atom id='3' name='HA2' element='H' hybrid='sp' type='HC' chg='0'/>
  <atom id='4' name='HA2' element='H' hybrid='sp' type='HC' chg='0'/>
  <atom id='10' name='C' element='C' hybrid='sp2' type='C' chg='0'/>
  <atom id='11' name='O' element='O' hybrid='sp2' type='O' chg='0'/>
  <bond order='single' from='1' to='2'/>
  <bond order='single' from='1' to='3'/>
  <bond order='single' from='1' to='4'/>
  <bond order='single' from='1' to='10'/>
  <bond order='double' from='10' to='11'/>
 </residue>
 <comment> </comment>
 <coupling in="peptide"></coupling>
 <coupling in="back"></coupling>
</mold>


<mold name="pro4">
   <monomers>
      <monomer name="pro4(2S4S)" pdb="OSS"/>
      <monomer name="pro4(2S4R)" pdb="OSR"/>
      <monomer name="pro4(2R4S)" pdb="ORS"/>
      <monomer name="pro4(2R4R)" pdb="ORR"/>
   </monomers>
   <residue id="2">
    <atom chg="0.460" element="C" hybrid="sp2" id="1" name="CAC" type="C"/>
    <atom chg="-0.545" element="O" hybrid="sp2" id="2" name="OA" type="O"/>
    <atom chg="0.151" element="C" hybrid="sp3" id="3" name="CA" type="CT"/>
    <atom chg="0.100" element="H" hybrid="sp3" id="4" name="HA" type="HA"/>
    <atom chg="0.141" element="N" hybrid="sp3" id="5" name="NA" type="N"/>
    <atom chg="0.642" element="C" hybrid="sp3" id="8" name="CD" type="CT"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="9" name="HD1" type="HA"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="10" name="HD2" type="HA"/>
    <atom chg="-2.389" element="C" hybrid="sp3" id="11" name="CG" type="CQ"/>
    <atom chg="0.466" element="C" hybrid="sp3" id="12" name="CB" type="CT"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="13" name="HB1" type="HA"/>
    <atom chg="0.090" element="H" hybrid="sp3" id="14" name="HB2" type="HA"/>
    <atom chg="1.156" element="C" hybrid="sp2" id="15" name="CGC" type="CCQ"/>
    <atom chg="-0.510" element="O" hybrid="sp2" id="16" name="OG" type="O"/>
    <atom chg="0.175" element="N" hybrid="sp3" id="17" name="NG" type="NQ"/>
    <atom chg="0.310" element="H" hybrid="sp3" id="18" name="HN" type="H"/>
    <bond from="1" order="single" to="3"/>
    <bond from="1" order="double" to="2"/>
    <bond from="3" order="single" to="4"/>
    <bond from="3" order="single" to="12"/>
    <bond from="3" order="single" to="5"/>
    <bond from="5" order="single" to="8"/>
    <bond from="8" order="single" to="9"/>
    <bond from="8" order="single" to="10"/>
    <bond from="8" order="single" to="11"/>
    <bond from="11" order="single" to="12"/>
    <bond from="11" order="single" to="15"/>
    <bond from="11" order="single" to="17"/>
    <bond from="12" order="single" to="13"/>
    <bond from="12" order="single" to="14"/>
    <bond from="15" order="double" to="16"/>
    <bond from="17" order="single" to="18"/>
   </residue>
   <charmmCode>
   DIHEdral NA CA CAC OA
   DIHEdral NG CG CGC OG
   DIHEdral CAC CA NA CD
   DIHEdral NA CD CG NG
   DIHEdral CA CB CG CGC
   DIHEdral CG CB CA NA
   DIHEdral CAC CA CB CG
   DIHEdral CD CG CGC OG
   DIHEdral CA CB CG NG
   DIHEdral CB CA CAC OA
   DIHEdral CD CG NG HN
   DIHEdral CA CB CG CD
   DIHEdral CB CG NG HN
   DIHEdral CB CA NA CD
   DIHEdral CB CG CD NA
   DIHEdral CGC CG CD NA
   DIHEdral CB CG CGC OG
   DIHEdral CGC CG NG HN
   DIHEdral CA NA CD CG
   </charmmCode>
   <coupling in="dkp">dkp</coupling>
   <coupling in="dkp">peptide ester</coupling>
   <coupling in="peptide">dkp back</coupling>
   <coupling in="peptide">peptide back ester</coupling>
  </mold>
  <mold name="H_2">
   <monomers>
	<monomer name="h_2" pdb="h2 "/>
   </monomers>
   <residue id="6">
    <atom chg="0.246" element="H" hybrid="sp3" id="1" name="H" type="HC"/>
    <atom chg="0.246" element="H" hybrid="sp3" id="2" name="HX1" type="HC"/>
   </residue>
   <coupling in="back"/>
  </mold>



<mold name="glycine">
 <groups>AminoAcid</groups>
 <monomers>
   <monomer name="gly" pdb="GLY"/>
 </monomers>
 <residue>
  <atom id='1' name='CA' element='C' hybrid='sp3' type='CT' chg='0'/>
  <atom id='2' name='HA1' element='H' hybrid='sp' type='HA' chg='0'/>
  <atom id='3' name='HA2' element='H' hybrid='sp' type='HA' chg='0'/>
  <atom id='4' name='N' element='N' hybrid='sp3' type='NH1' chg='0'/>
  <atom id='5' name='H' element='H' hybrid='sp3' type='H' chg='0'/>
  <atom id='10' name='C' element='C' hybrid='sp2' type='C' chg='0'/>
  <atom id='11' name='O' element='O' hybrid='sp2' type='O' chg='0'/>
  <bond order='single' from='1' to='3'/>
  <bond order='single' from='1' to='2'/>
  <bond order='single' from='1' to='10'/>
  <bond order='single' from='1' to='4'/>
  <bond order='single' from='4' to='5'/>
  <bond order='double' from='10' to='11'/>
 </residue>
 <couplingAtoms>C N</couplingAtoms>
 <comment> </comment>
 <coupling in="dkp"></coupling>
 <coupling>dkp</coupling>
</mold>


<couplingRule name="dkp">
 <in><mold>pro4</mold></in>
 <out><mold>pro4</mold></out>
 <code>
  <bond in="NG" out="CAC" order="single"/>
  <bond in="CGC" out="NA" order="single"/>
<charmmCode>
add DIHEdral -CGC +NA +CA +CB
add DIHEdral -CGC +NA +CA +CAC
add DIHEdral -CGC +NA +CD +CG
add DIHEdral -CB -CG -CGC +NA
add DIHEdral -CD -CG -CGC +NA
add DIHEdral -CB -CG -NG +CAC
add DIHEdral -NG +CAC +CA +NA
add DIHEdral -CD -CG -NG +CAC
add DIHEdral -CGC -CG -NG +CAC
add DIHEdral -NG -CG -CGC +NA
add DIHEdral -NG +CAC +CA +CB
add impr -CG -CGC +NA +CA ! impr would be ambiguous
add impr -OG -CGC +NA +CA ! impr would be ambiguous
add impr -CG -OG +NA -CGC ! maintain planarity of CO, ideal 0 deg
add impr -CGC +CD +CA +NA ! maintain planarity of N, ideal 0 deg

add IMPRoper -CG -NG +CAC +CA
add IMPRoper -CG -NG +CAC +OA
add IMPRoper -HN -NG +CAC +CA
add IMPRoper -HN -NG +CAC +OA
</charmmCode>
 </code>
</couplingRule>


<couplingRule name="peptide">
 <in><mold>pro4</mold></in>
 <out> <mold>pro4 acetate</mold> </out>
 <code>
  <bond in="NG" out="CAC" order="single"/>
 </code>
</couplingRule>

<couplingRule name="dkp">
 <in><group>AminoAcid</group></in>
 <out><mold>pro4</mold></out>
 <code>
  <bond in="N" out="CAC" order="single"/>
  <bond in="C" out="NA" order="single"/>
 </code>
</couplingRule>



<couplingRule name="dkp">
 <in><mold>pro4</mold></in>
 <out><group>AminoAcid</group></out>
 <code>
  <bond in="NG" out="CAC" order="single"/>
  <bond in="CGC" out="NA" order="single"/>
<charmmCode>
add DIHEdral -CGC +NA +CA +CB
add DIHEdral -NG +CAC +CA +NA
add DIHEdral -CGC +NA +CA +CAC
add DIHEdral -CD -CG -CGC +NA
add DIHEdral -CB -CG -CGC +NA
add DIHEdral -NG +CAC +CA +CB
add DIHEdral -CB -CG -NG +CAC
add DIHEdral -CD -CG -NG +CAC
add DIHEdral -CGC -CG -NG +CAC
add DIHEdral -NG -CG -CGC +NA
add IMPRoper -CG -CGC +NA +HN
add IMPRoper -CG -CGC +NA +CA
add IMPRoper -CG -NG +CAC +CA
add IMPRoper -CG -NG +CAC +OA
add IMPRoper -HN -NG +CAC +CA
add IMPRoper -HN -NG +CAC +OA
add IMPRoper -OG -CGC +NA +HN
add IMPRoper -OG -CGC +NA +CA
</charmmCode>
 </code>
</couplingRule>



<couplingRule name="dkp">
 <in><group>AminoAcid</group></in>
 <out><group>AminoAcid</group></out>
 <code>
  <bond in="N" out="C" order="single"/>
  <bond in="C" out="N" order="single"/>
 </code>
</couplingRule>



<couplingRule name="peptide">
 <in><mold>resinAmide</mold></in>
 <out><mold>pro4</mold></out>
 <code>
  <bond in="N" out="CAC" order="single"/>
  <charmmCode>
add DIHEdral -N +CAC +CA +CB
add DIHEdral -N +CAC +CA +NA
add IMPRoper -HN1 -N +CAC +OA
add IMPRoper -HN1 -N +CAC +CA
add IMPRoper -HN1 -HN2 +CAC -N	! maintain planarity
  </charmmCode>
 </code>
</couplingRule>


<couplingRule name="back">
 <in><mold>pro4</mold></in>
 <out><mold>H_2</mold></out>
 <code>
  <bond in="NA" out="H" order="single"/>
  <bond in="NA" out="HX1" order="single"/>
  <modifyAtom inOrOut="in" name="NA" newType="NH3"/>
 </code>
</couplingRule>


<couplingRule name="back">
 <in><mold>pro4</mold></in>
 <out><mold>acetate</mold></out>
 <code>
  <bond in="NA" out="CAC" order="single"/>
 </code>
</couplingRule>



</topologyDatabase>




<ConformationDatabase >

 <MonomerCoordinates>
   <Context>
	<Self><mold>resinAmide</mold></Self>
   </Context>
   <MonomerFragment id="all">
	<ZMatrixExtractor>
		=HN1
		=N HN1
		=HN2 N HN1
	</ZMatrixExtractor>
   </MonomerFragment>
 </MonomerCoordinates>

 <MonomerCoordinates>
   <Context>
	<Self><mold>pro4</mold></Self>
        <In coupling="peptide">
	    <monomerName>resinAmide</monomerName>
        </In>
	<Out coupling="dkp">
		<mold>pro4</mold>
	</Out>
   </Context>
   <DefineBuilders fileName="Pro4/amide.xml"/>
   <FragmentOrder>
	<Pass1>all</Pass1>
	<Pass2>dkp</Pass2>
   </FragmentOrder>
   <MonomerFragment id="all">
	<ZMatrixExtractor>
	    =CAC -N -HN1 -HN2
	    =OA CAC -N -HN1
	    =CA CAC -N -HN1
	    =CB CA CAC -OH
	    =CG CB CA CAC
	    =CD CG CB CA
	    =NA CD CG CB
	    =HA CA NA CB
	    =HB1 CB CA CG
	    =HB2 CB CA CG
	    =HD1 CD CG NA
	    =HD2 CD CG NA
	    =CGC CG CB CD
	    =NG CG CB CD
	</ZMatrixExtractor>
   </MonomerFragment>
   <MonomerFragment id="dkp">
	<ZMatrixExtractor outCoupling="dkp">
	    =OG CGC +NA CG
	    =HN NG +CAC CG
	</ZMatrixExtractor>
   </MonomerFragment>
 </MonomerCoordinates>

 <MonomerCoordinates>
   <Context>
	<Self><mold>pro4</mold></Self>
        <In coupling="dkp">
	    <mold>pro4</mold>
        </In>
	<Out coupling="dkp">
		<mold>pro4</mold><group>AminoAcid</group>
	</Out>
   </Context>
   <FragmentOrder>
	<Pass1>core</Pass1>
	<Pass2>dkpAtoms</Pass2>
   </FragmentOrder>
   <conformation name="ring" id="all"/>
   <MonomerFragment id="core">
	<ZMatrixExtractor>
	    =CAC -NG -CG -CGC
	    =OA CAC -NG -CG
	    =CA CAC -NG -CG
	    =CB CA CAC -NG
	    =CG CB CA CAC
	    =CD CG CB CA
	    =NA CD CG CB
	    =HA CA NA CB
	    =HB1 CB CA CG
	    =HB2 CB CA CG
	    =HD1 CD CG NA
	    =HD2 CD CG NA
	    =CGC CG CB CD
	    =NG CG CB CD
	</ZMatrixExtractor>
<!--
	<ranking>xxx</ranking>
	<builder name="xxx" comment="lowest energy">
	    =CAC -NG -CG -CGC
	    =OA CAC -NG -CG
	    =CA CAC -NG -CG
	    =CB CA CAC -NG
	    =CG CB CA CAC
	    =CD CG CB CA
	    =NA CD CG CB
	    =HA CA NA CB
	    =HB1 CB CA CG
	    =HB2 CB CA CG
	    =HD1 CD CG NA
	    =HD2 CD CG NA
	    =CGC CG CB CD
	    =NG CG CB CD
	</builder>
-->
   </MonomerFragment>
   <MonomerFragment id="dkpAtoms">
	<ZMatrixExtractor outCoupling="dkp">
	    =OG CGC +NA CG
	    =HN NG +CAC CG
	</ZMatrixExtractor>
   </MonomerFragment>
 </MonomerCoordinates>


 <MonomerCoordinates>
   <Extractor>
	<Extract fileName="xxxx" self="tyr"/>
   </Extractor>
   <Context>
	<Self>tyr</Self>
        <In coupling="dkp">
	    <mold>pro4</mold>
        </In>
   </Context>
   <FragmentOrder>
	<Pass1>backbone sideChain</Pass1>
   </FragmentOrder>
   <MonomerFragment id="backbone">
	<ZMatrixExtractor>
	    =CAC -NG -CG -CGC
	    =OA CAC -NG -CG
	    =CA CAC -NG -CG
	    =CB CA CAC -NG
	    =HA CA CB CAC
	    =NA CA CAC -NG
	    =HN NA CA CAC
	</ZMatrixExtractor>
   </MonomerFragment>
   <MonomerFragment id="sideChain">
   	<Dihedral name="X1" target="C1" bond="CB" angle="CA" dihedral="CAC"/>
   	<Dihedral name="X2" target="C2" bond="C1" angle="CB" dihedral="CA"/>
	<ZMatrixExtractor>
	     =C1 CB CA ~X1 CAC   <!-- X1 dihedral-->
	     =HB1 CB C1 CA
	     =HB2 CB C1 CA
	     =C2 C1 CB ~X2 CA    <!-- relative to X2 dihedral-->
	     =C3 C2 C1 CB
	     =C4 C3 C2 C1
	     =C5 C4 C3 C2
	     =C6 C5 C4 C3
	     =H2 C2 C1 C3
	     =H3 C3 C2 C4
	     =O4 C3 C2 C4
	     =H4 O4 C4 C3
	</ZMatrixExtractor>
   </MonomerFragment>
 </MonomerCoordinates>



</ConformationDatabase>


</extractorDatabase>
